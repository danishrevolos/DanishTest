<app-header [headdata]="pagedata.head"></app-header>
<section class="flat-row section-iconbox">
    <div class="container" [ngClass]="{'hidden':pagedata.head.status!=='I'}">
        <div class="row">
            <div class="col-xs-12" style="z-index:1">
                <div class="title-section style3 left">
                    <h1 class="title">Create New Quote & Contract</h1>
                </div>

            </div>
            <div class="white pull-left w100 stepsblock">
                <ul class="nav nav-wizard" id="quotesteps">
                    <li [class.active]="hasQuote1">
                        <a *ngIf="hasQuote1" routerLink="/app/Quote1">Vehicle</a>
                        <a *ngIf="!hasQuote1" routerLink="/app/Results">Vehicle</a>
                    </li>
                    <li [class.active]="hasQuote1">
                        <a *ngIf="hasQuote1" routerLink="/app/Quote2">Product</a>
                        <a *ngIf="!hasQuote1" routerLink="/app/Results">Product</a>
                    </li>
                    <li class="active">
                        <a href="javascript:void(0)">Quote</a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="row white" style="min-height:400px">
                <div [class.hidden]="loading">
                <div class="col-md-12" style="margin-top:10px" >
                    <div class="alert alert-success" role="alert" [ngClass]="{'alert-success':dispAlert.status==='S',
                                  'alert-danger':dispAlert.status==='E',
                                  'hidden':dispAlert.message===''}">{{dispAlert.message}}</div>

                </div>
                <div clas="row" *ngIf="pagedata.body.pagemode == '3'">
                    <div class="col-md-7" style="padding:0">
                        <div class="well well-sm sectionlabel active" style="margin:10px" *ngIf="pagedata.body.veh">
                            <div class="sectiontop" id="sec1" (click)="toggleVeh()">
                                <h3 class="firsth">Vehicle Details</h3>
                                <span class="vehspan"style="display:inline-block;padding:6px 0px 0px 10px"  [ngClass]="{'hidden':expvehc}" >( {{pagedata.body.veh.year}} {{pagedata.body.veh.make}} / {{pagedata.body.veh.model}} )</span>
                                <i class="fa sectiond fa-minus"  [ngClass]="{'fa-minus':expvehc,'fa-plus':!expvehc}"></i>
                                    <div class="clearfix"></div>
                            </div>

                            <div class="viewcont closed" id="sectionVeh" [ngClass]="{'closed':!expvehc}" style="padding:0;overflow-y:hidden">
                                <hr>
                                <table class="table table-striped" style="margin-bottom:0">
                                    <tbody>
                                        <tr>
                                            <td class="text-right" style="width:40%">
                                                <b>Year:</b>
                                            </td>
                                            <td class="text-left" style="width:60%">{{pagedata.body.veh.year}}
                                                <div class="pull-right" *ngIf="hasQuote1">
                                                    <a  routerLink="/app/Quote1" class="flat-button pull-right nextsection" section="2" id="submit" title="Edit" style="padding:2px 8px">Edit</a>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-right">
                                                <b>Make:</b>
                                            </td>
                                            <td class="text-left">{{pagedata.body.veh.make}}</td>
                                        </tr>
                                        <tr>
                                            <td class="text-right">
                                                <b>Model:</b>
                                            </td>
                                            <td class="text-left">{{pagedata.body.veh.model}}</td>
                                        </tr>
                                        <tr>
                                            <td class="text-right">
                                                <b>Mileage:</b>
                                            </td>
                                            <td class="text-left">{{pagedata.body.veh.miles}}</td>
                                        </tr>
                                        <tr *ngIf="pagedata.body.veh.price ==''">
                                            <td class="text-right">
                                                <b>VIN:</b>
                                            </td>
                                            <td class="text-left">{{pagedata.body.veh.vin}}</td>
                                        </tr>
                                        <tr *ngIf="pagedata.body.veh.price !==''">
                                            <td class="text-right">
                                                <b>Purchase Price:</b>
                                            </td>
                                            <td class="text-left">{{pagedata.body.veh.price | currency}}</td>
                                        </tr>
                                        <tr>
                                            <td class="text-right">
                                                <b>In-Service:</b>
                                            </td>
                                            <td class="text-left">{{pagedata.body.veh.insrvc}}</td>
                                        </tr>
                                        <tr *ngIf="listvf>0">
                                            <td class="text-right">
                                                <b>Vehicle Features:</b>
                                            </td>
                                            <td class="text-left">
                                              <ng-container *ngFor="let VF of pagedata.body.srchg;let i=index;">
                                                <span *ngIf="VF.type =='VF'">{{VF.code}}&nbsp;&nbsp;</span>
                                              </ng-container>  
                                            </td>
                                        </tr>
                                        <tr *ngIf="listoc>0">
                                            <td class="text-right">
                                                <b>Optional Coverages:</b>
                                            </td>
                                            <td class="text-left">
                                                <ng-container *ngFor="let OC of pagedata.body.srchg;let i=index;">
                                                    <span *ngIf="OC.type =='OC'">{{OC.code}}&nbsp;&nbsp;</span>
                                                </ng-container>  
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div class="clearfix"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-5" style="padding:0">
                        <div class="well well-sm sectionlabel active" style="margin:10px">
                            <div class="sectiontop" id="sec2"  (click)="toggleCalc()">
                                <h3 class="firsth">Payment Calculator</h3>
                                <i class="fa sectiond" [ngClass]="{'fa-minus':expcalc,'fa-plus':!expcalc}"></i>
                                <div class="clearfix"></div>
                            </div>

                            <div class="viewcont closed" id="section2" [ngClass]="{'closed':!expcalc}" style="padding:0;overflow-y:hidden;">
                                <hr>
                                <div class="calculator">

                                    <div class="col-xs-6">
                                        <label class="flat-input inputlabel" style="margin-top:10px">Total Price</label>
                                        <div class="flat-input w100">
                                            <input  type="text" placeholder="Total Price" name="totalp" [(ngModel)]="totalp" (keyup)="calcChng('totalp')" >
                                        </div>
                                        <label class="flat-input inputlabel" style="margin-top:10px">Min 5% Down</label>
                                        <div class="flat-input w100">
                                            <select class="form__select w100" name="mindwn" [(ngModel)]="mindwn" (change)="calcChng('mindwn')" >
                                                <option value="5">5%</option>
                                                <option value="10">10%</option>
                                                <option value="20">20%</option>
                                                <option value="30">30%</option>
                                                <option value="40">40%</option>
                                                <option value="100">Full Pay</option>
                                            </select>
                                        </div>
                                        <label class="flat-input inputlabel" style="margin-top:10px">Down Payment</label>
                                        <div class="flat-input w100">
                                            <div style="padding:0">
                                                <input type="text" placeholder="Down Payment" name="downpm" [(ngModel)]="downpm" (keyup)="calcChng('downpm')" >
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-xs-6">
                                        <label class="flat-input inputlabel" style="margin-top:10px"># Months</label>
                                        <div class="flat-input w100">
                                            <select class="form__select w100" name="months" [(ngModel)]="months"  (change)="calcChng('months')" >
                                                <option value="12">12</option>
                                                <option value="15">15</option>
                                                <option value="18">18</option>
                                                <option value="24">24</option>
                                            </select>
                                        </div>
                                        <label class="flat-input inputlabel" style="margin-top:10px">Monthly Payment</label>
                                        <div class="flat-input w100">
                                            <div style="padding:0">
                                                <input name="mthlyp" [(ngModel)]="mthlyp" type="text" placeholder="Monthly Payment" disabled >
                                            </div>
                                        </div>
                                        <label class="flat-input inputlabel" style="margin-top:10px">Balance</label>
                                        <div class="flat-input w100">
                                            <div style="padding:0">
                                                <input name="balnce" [(ngModel)]="balnce" type="text" placeholder="Balance" disabled >
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="clearfix"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div clas="row" *ngIf="pagedata.body.pagemode == 'R'">
                        
                        <div class="col-md-6" style="padding:0">
                            <div class="well well-sm sectionlabel active" style="margin:10px" *ngIf="pagedata.body.veh">
                                <h3 class="firsth">Vehicle Details</h3>
                                <div class="clearfix"></div>
                                <div class="viewcont" id="sectionVeh" style="padding:0;overflow-y:hidden">
                                    <hr>
                                    <table class="table table-striped" style="margin-bottom:0">
                                        <tbody>
                                            <tr>
                                                <td class="text-right" style="width:40%">
                                                    <b>Year:</b>
                                                </td>
                                                <td class="text-left" style="width:60%">{{pagedata.body.veh.year}}</td>
                                            </tr>
                                            <tr>
                                                <td class="text-right">
                                                    <b>Make:</b>
                                                </td>
                                                <td class="text-left">{{pagedata.body.veh.make}}</td>
                                            </tr>
                                            <tr>
                                                <td class="text-right">
                                                    <b>Model:</b>
                                                </td>
                                                <td class="text-left">{{pagedata.body.veh.model}}</td>
                                            </tr>
                                            <tr>
                                                <td class="text-right">
                                                    <b>Mileage:</b>
                                                </td>
                                                <td class="text-left">{{pagedata.body.veh.miles}}</td>
                                            </tr>
                                            <tr *ngIf="pagedata.body.veh.price =='' && pagedata.body.veh.vin !== 'n/a'">
                                                <td class="text-right">
                                                    <b>VIN:</b>
                                                </td>
                                                <td class="text-left">{{pagedata.body.veh.vin}}</td>
                                            </tr>
                                            <tr *ngIf="pagedata.body.veh.price !==''">
                                                <td class="text-right">
                                                    <b>Purchase Price:</b>
                                                </td>
                                                <td class="text-left">{{pagedata.body.veh.price | currency}}</td>
                                            </tr>
                                            <tr>
                                                <td class="text-right">
                                                    <b>In-Service:</b>
                                                </td>
                                                <td class="text-left">{{pagedata.body.veh.insrvc}}</td>
                                            </tr>
                                            <tr *ngIf="listvf>0">
                                                <td class="text-right">
                                                    <b>Vehicle Features:</b>
                                                </td>
                                                <td class="text-left">
                                                    <ng-container *ngFor="let VF of pagedata.body.srchg;let i=index;">
                                                        <span *ngIf="VF.type =='VF'">{{VF.code}}&nbsp;&nbsp;</span>
                                                    </ng-container>
                                                </td>
                                            </tr>
                                            <tr *ngIf="listoc>0">
                                                <td class="text-right">
                                                    <b>Optional Coverages:</b>
                                                </td>
                                                <td class="text-left">
                                                    <ng-container *ngFor="let OC of pagedata.body.srchg;let i=index;">
                                                        <span *ngIf="OC.type =='OC'">{{OC.code}}&nbsp;&nbsp;</span>
                                                    </ng-container>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <div class="clearfix"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6" style="padding:0">
                                <div class="well well-sm sectionlabel active" style="margin:10px">
                                    <h3 class="firsth pull-left">Customer</h3>
                                    <div class="pull-right">
                                        <a href="javascript:void(0)" (click)="mode3()" class="flat-button pull-right nextsection" section="2" id="submit" title="Edit" style="padding:2px 8px;margin-top:3px;">Edit</a>
                                    </div>
                                    <div class="clearfix"></div>
                                    <div class="viewcont" id="sectionVeh" style="padding:0;overflow-y:hidden">
                                        <hr>
                                        <table class="table table-striped" style="margin-bottom:0">
                                            <tbody>
                                                <tr>
                                                    <td class="text-right">
                                                        <b>Quote ID:</b>
                                                    </td>
                                                    <td class="text-left">{{pagedata.body.qtid}}</td>
                                                </tr>
                                                <tr>
                                                    <td class="text-right" style="width:40%">
                                                        <b>Stock #/Member ID:</b>
                                                    </td>
                                                    <td class="text-left" style="width:60%">{{pagedata.body.stock}}</td>
                                                </tr>
                                                
                                                <tr>
                                                    <td class="text-right">
                                                        <b>Name:</b>
                                                    </td>
                                                    <td class="text-left">{{pagedata.body.first +' '+pagedata.body.last}}</td>
                                                </tr>
                                                <tr *ngIf="pagedata.body.cbfirst!==''">
                                                    <td class="text-right">
                                                        <b>Co-buyer:</b>
                                                    </td>
                                                    <td class="text-left">{{pagedata.body.cbfirst +' '+pagedata.body.cblast}}</td>
                                                </tr>
                                                <tr *ngIf="pagedata.body.email !== ''">
                                                    <td class="text-right">
                                                        <b>Email:</b>
                                                    </td>
                                                    <td class="text-left">{{pagedata.body.email}}</td>
                                                </tr>
                                                <tr *ngIf="pagedata.body.phone !== ''">
                                                    <td class="text-right">
                                                        <b>Phone:</b>
                                                    </td>
                                                    <td class="text-left">{{pagedata.body.phone}}</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <div class="clearfix"></div>
                                    </div>
                                </div>
                            </div>
                    </div>
                <div class="clearfix"></div>
            <form  *ngIf="pagedata.body.pagemode == '3'" class="contactform style4 clearfix panel-body" method="post" action="javascript:void(0);" (submit)="checkData()" novalidate  autocomplete="off">
                <div class="hidden-md hidden-lg">
                    <ng-container *ngFor="let datads of pagedata.body.data">
                        <div class="well well-sm productsel" [class.hidden]="!datads.open" (click)="showLeft()">
                            <h3 class="pull-left" style="margin:0">Product - {{datads.desc}}</h3>
                            <i class="fa fa-bars pull-right" id="plussquare"></i>
                            <div class="clearfix"></div>
                        </div>
                    </ng-container>
                </div>
                <div class="col-md-3 step3left hidden-sm hidden-xs" id="step3left">
                    <div class="closeleft hidden-md hidden-lg" (click)="hideLeft()">
                        <h3 class="pull-left">Product</h3>
                        <i class="pull-right fa fa-times"></i>
                    </div>
                    <h3 class="hidden-sm hidden-xs">Product</h3>
                    <div class="clearfix"></div>
                    <div class="well well-sm sectionlabel" *ngFor="let datads of pagedata.body.data; let m = index">

                        <div class="sectiontop" (click)="toggle(datads)">
                            <h4 class="pull-left" style="margin:5px 0 5px 5px;max-width:83%">{{datads.desc}}</h4>
                            <i class="fa sectiond" [ngClass]="{'hidden':datads.open,'fa-caret-down':!datads.open}"></i>
                            <div class="clearfix"></div>
                        </div>
                        <div class="viewcont2" [class.closed]="!datads.open">
                            <hr style="margin:-10px 0 20px 0">

                            <h5 style="margin-bottom:3px">Eligibility</h5>
                            <!--New-->
                                <span class="flat-input-checkbox" *ngIf="datads.dspn">
                                    <div class="custradio">
                                        <input name="eligibility{{datads.prg+datads.ratc}}" (change)="eligibility(m)" [(ngModel)]="datads.nup" value="N" id="nupN{{datads.prg+datads.ratc}}" type="radio" [checked]="pagedata.body.ctyp =='N' ? true : false" >
                                        <label for="nupN{{datads.prg+datads.ratc}}"></label>
                                    </div>
                                    <label class="checklabel" for="nupN{{datads.prg+datads.ratc}}">New</label>
                                </span>
                            <!--Used-->
                                <span class="flat-input-checkbox" *ngIf="datads.dspu">
                                    <div class="custradio">
                                        <input name="eligibility{{datads.prg+datads.ratc}}"  (change)="eligibility(m)" [(ngModel)]="datads.nup" value="U" id="nupU{{datads.prg+datads.ratc}}" type="radio" [checked]="pagedata.body.ctyp =='U' ? true : false" >
                                        <label for="nupU{{datads.prg+datads.ratc}}"></label>
                                    </div>
                                    <label class="checklabel" for="nupU{{datads.prg+datads.ratc}}">Used</label>
                                </span>
                            <!--Program-->
                                <span class="flat-input-checkbox" *ngIf="datads.dspp">
                                    <div class="custradio">
                                        <input name="eligibility{{datads.prg+datads.ratc}}"  (change)="eligibility(m)" [(ngModel)]="datads.nup" value="P" id="nupP{{datads.prg+datads.ratc}}" type="radio" [checked]="pagedata.body.ctyp =='P' ? true : false" >
                                        <label for="nupP{{datads.prg+datads.ratc}}"></label>
                                    </div>
                                    <label class="checklabel" for="nupP{{datads.prg+datads.ratc}}">Program</label>
                                </span>
                            <!--Stacked-->
                            <hr style="margin:5px 0 15px 0">

                            

                            <h5 style="margin-bottom:3px">Coverages</h5>
                            <ng-container *ngFor="let coverage of datads.cov.coverages">
                                <span class="flat-input-checkbox" *ngIf="!coverage.check" [class.hidden]="coverage.disbl || coverage.dup || coverage.nup !== datads.nup" [class.disbl]="coverage.disbl"  [class.dup]="coverage.dup"  [class.nup]="coverage.nup  !== datads.nup"  >
                                    <div class="custcheck">
                                        <input name="plan" [checked]="coverage.check2" value="{{coverage.termc}}" id="check{{datads.prg+datads.ratc+coverage.termc}}"
                                            type="checkbox" class="c1" [checked]="coverage.check2"  (change)="toggleCov(coverage,'C',datads.prg,datads.ratc,m)">
                                        <label for="check{{datads.prg+datads.ratc+coverage.termc}}"></label>
                                    </div>
                                    <label class="checklabel" for="check{{datads.prg+datads.ratc+coverage.termc}}">{{coverage.desc | uppercase}}</label>
                                </span>
                            </ng-container>
                            <!--Stacked-->
                            <hr style="margin:5px 0 15px 0">
                            <h5 style="margin-bottom:3px">Terms</h5>
                            <ng-container *ngFor="let term of datads.trm.terms">
                                <span class="flat-input-checkbox" *ngIf="!term.check" [class.hidden]="term.disbl">
                                    <div class="custcheck">
                                        <input name="plan" [checked]="term.check2" value="{{term.termm}}" id="check{{datads.prg+datads.ratc+term.termm+term.miles}}"
                                            type="checkbox" class="c1" [checked]="term.check2"  (change)="togglebox(term,'T',datads.prg,datads.ratc,m)">
                                        <label for="check{{datads.prg+datads.ratc+term.termm+term.miles}}"></label>
                                    </div>
                                    <label class="checklabel" for="check{{datads.prg+datads.ratc+term.termm+term.miles}}">
                                        <span>{{term.termm}} Months</span> / {{term.miles|number:0}}</label>
                                </span>
                            </ng-container>
                            <hr style="margin:5px 0 15px 0">
                            <h5 style="margin-bottom:3px">Deductibles</h5>
                            <ng-container *ngFor="let deductible of datads.ded.deductibles">
                                <span class="flat-input-checkbox" *ngIf="!deductible.check" [class.hidden]="deductible.disbl">
                                    <div class="custcheck">
                                        <input name="plan" [checked]="deductible.check2" value="{{deductible.code}}" id="check{{datads.prg+datads.ratc+deductible.code}}"
                                            type="checkbox" class="c1" [checked]="deductible.check2"  (change)="togglebox(deductible,'D',datads.prg,datads.ratc,m)">
                                        <label for="check{{datads.prg+datads.ratc+deductible.code}}"></label>
                                    </div>
                                    <label class="checklabel" for="check{{datads.prg+datads.ratc+deductible.code}}">{{deductible.desc}}</label>
                                </span>
                            </ng-container>
                            
                        </div>
                    </div>
                    <a href="javascript:void(0)" (click)="hideLeft()" style="margin:15px" class="btn btn-primary pull-right hidden-md hidden-lg">View Results</a>
                </div>
                <!--Tables-->
                <div class="col-md-9">
                    <ng-container *ngFor="let element of pagedata.body.tables;let p = index">
                        <ng-container *ngIf="p==firsttable">
                        <div class="alert alert-info" *ngIf="element.errorDetail !=='' && element.errorDetail !== undefined" style="margin-bottom: 0">
                            {{xlateprg(element.prgm,element.ratc) +': '+element.errorDetail}}
                        </div>
                        <div class="alert alert-danger" *ngIf="element.errmsg !=='' && element.errmsg !== undefined && element.errorDetail==undefined" style="margin-bottom: 0">
                            {{xlateprg(element.prgm,element.ratc) +': '+element.errmsg}}
                        </div>
                        <div style="padding:0;" [class.col-sm-5]="element.showct" [class.col-md-12]="!element.showct" >
                            <h2 style="overflow: hidden;text-overflow: ellipsis;white-space: nowrap;padding-top: 20px;margin-bottom:8px;padding-left:3px">{{element.desc}} </h2>
                        </div>
                        <div class="col-sm-7" style="padding: 0;" *ngIf="element.showct">
                        <div class="text-right" *ngIf="element.rates !== undefined && element.rates.length > 0">
                        <h6 style="margin:0px">Contract Type</h6>
                        <a href="javascript:void(0)" (click)="applySurch('C')" [class.hidden]="element.catg !== 'OTC'" class="btn btn-primary" style="margin: 1px;padding: 8px;float: right;">APPLY</a>
                        <input name="onetime{{p}}" (focus)="otcOn()" (blur)="otcOff()" type="number" [class.hidden]="element.catg !== 'OTC'" [(ngModel)]="element.onetime"  autocomplete="off" placeholder="Charge" style="margin:0 3px;width:80px;float:right;padding-left:8px;">
                        <select class="form__select pull-right" name="year{{element.rates[0].program+element.rates[0].ratc}}" [(ngModel)]="element.ctrct" style="margin-bottom:3px;width:60%;" (change)="applySurch('C')">
                            <ng-container *ngFor="let cont of pagedata.body.contracts">
                                <option  *ngIf="cont.prgm.padEnd(20) == element.rates[0].program.padEnd(10) +element.rates[0].ratc.padEnd(10)" [value]=" element.rates[0].program.padEnd(10) +element.rates[0].ratc.padEnd(10)+cont.code.padEnd(30)+cont.valu" [attr.selected]="element.ctrct==(cont.prgm.padEnd(20) + cont.code.padEnd(30) + cont.valu) ? true : null">{{cont.desc}}</option>
                            </ng-container>
                        </select>
                            
                        </div>
                        </div>
                    <div class="clearfix"></div>
                    <ng-container *ngFor="let table of element.rates;let t = index">
                        <div class="well well-sm" style="background:white" *ngIf="table.check && table.nup === element.nup">
                            <h3 class="coverage">{{table.title}}   <span class="pull-right" style="color:gray" *ngIf="table.nup =='N'">(New)</span>
                                                                   <span class="pull-right" style="color:gray" *ngIf="table.nup =='U'">(Used)</span>
                                                                   <span class="pull-right" style="color:gray" *ngIf="table.nup =='P'">(Program)</span></h3>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th scope="col">
                                            <b>Months / Miles</b>
                                        </th>
                                        <ng-container *ngFor="let col of table.cols" >
                                            <th scope="col" *ngIf="col.check">
                                                 <b>${{col.ded}}</b>
                                            </th>
                                        </ng-container>
                                    </tr>
                                </thead>
                                <tbody>

                                    <ng-container *ngFor="let row of table.rows;let r = index" >
                                    <tr *ngIf="row.check">
                                        <th scope="row" style="font-weight: bold">
                                            <span>{{row.mon}} Months</span> / {{row.mil|number:0}}
                                        </th>
                                    <ng-container *ngFor="let col of table.cols;let c = index" >
                                        <td *ngIf="col.check">
                                            <ng-container *ngIf="table.data[r][c][0]>0">
                                            <div class="custcheck" *ngIf="table.data[r][c]!==undefined">
                                                <input name="plan" id="cell{{table.program+table.coverage+r+c}}" type="checkbox" class="c2" [checked]="table.data[r][c][2]==1" (change)="selectCov($event,p,t,r,c)">
                                                <label for="cell{{table.program+table.coverage+r+c}}"></label>
                                            </div>
                                            <ng-container *ngFor="let inAr of table.data[r][c];let g = index">
                                                <label *ngIf="g==0" class="checklabel labelprice" for="cell{{table.program+table.coverage+r+c}}">{{ inAr | currency}}</label>
                                            </ng-container>
                                            </ng-container>
                                            <ng-container *ngIf="table.data[r][c][0]<0">N/A</ng-container>
                                        </td>
                                    </ng-container>
                                    </tr>
                                    </ng-container>
                                </tbody>
                            </table>
                        </div>
                    </ng-container>
                    
                    <hr *ngIf="p<=(pagedata.body.tables.length-1)" style="border-top:1px solid black;">
                    <hr *ngIf="p<=(pagedata.body.tables.length-1)" style="border-top:1px solid black;">
                </ng-container>
                </ng-container>

                <!--Repeated to sort only-->
                    <ng-container *ngFor="let element of pagedata.body.tables;let p = index">
                        <ng-container *ngIf="p!==firsttable">
                        <div class="alert alert-info" *ngIf="element.errorDetail !=='' && element.errorDetail !== undefined">
                            {{xlateprg(element.prgm,element.ratc) +': '+element.errorDetail}}
                        </div>
                        <div class="alert alert-danger" *ngIf="element.errmsg !=='' && element.errmsg !== undefined && element.errorDetail==undefined">
                            {{xlateprg(element.prgm,element.ratc) +': '+element.errmsg}}
                        </div>
                        <div style="padding:0;"  [class.col-md-5]="element.showct" [class.col-md-12]="!element.showct">
                            <h2 style="overflow: hidden;text-overflow: ellipsis;white-space: nowrap;padding-top: 20px;margin-bottom:8px;padding-left:3px">{{element.desc}} </h2>
                        </div>
                        <div class="col-md-7" style="padding: 0;" *ngIf="element.showct">
                        <div class="text-right" *ngIf="element.rates !== undefined && element.rates.length > 0">
                        <h6 style="margin:0px">Contract Type</h6>
                        <a href="javascript:void(0)" (click)="applySurch('C')" [class.hidden]="element.catg !== 'OTC'" class="btn btn-primary" style="margin: 1px;padding: 8px;float: right;">APPLY</a>
                        <input name="onetime{{p}}" (focus)="otcOn()" (blur)="otcOff()" type="number" [class.hidden]="element.catg !== 'OTC'" [(ngModel)]="element.onetime"  autocomplete="off" placeholder="Charge" style="margin:0 3px;width:80px;float:right;padding-left:8px;">
                       <select class="form__select pull-right" name="year{{element.rates[0].program+element.rates[0].ratc}}" [(ngModel)]="element.ctrct" style="margin-bottom:3px;width:60%;" (change)="applySurch('C')">
                            <ng-container *ngFor="let cont of pagedata.body.contracts">
                                <option  *ngIf="cont.prgm.padEnd(20) == element.rates[0].program.padEnd(10) +element.rates[0].ratc.padEnd(10)" [value]=" element.rates[0].program.padEnd(10) +element.rates[0].ratc.padEnd(10)+cont.code.padEnd(30)+cont.valu" [attr.selected]="element.ctrct==(cont.prgm.padEnd(20) + cont.code.padEnd(30) + cont.valu) ? true : null">{{cont.desc}}</option>
                            </ng-container>
                        </select>
                            
                        </div>
                        </div>
                    <div class="clearfix"></div>
                    <ng-container *ngFor="let table of element.rates;let t = index">
                        <div class="well well-sm" style="background:white" *ngIf="table.check && table.nup === element.nup">
                            <h3 class="coverage">{{table.title}}   <span class="pull-right" style="color:gray" *ngIf="table.nup =='N'">(New)</span>
                                                                   <span class="pull-right" style="color:gray" *ngIf="table.nup =='U'">(Used)</span>
                                                                   <span class="pull-right" style="color:gray" *ngIf="table.nup =='P'">(Program)</span></h3>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th scope="col">
                                            <b>Months / Miles</b>
                                        </th>
                                        <ng-container *ngFor="let col of table.cols" >
                                            <th scope="col" *ngIf="col.check">
                                                 <b>${{col.ded}}</b>
                                            </th>
                                        </ng-container>
                                    </tr>
                                </thead>
                                <tbody>

                                    <ng-container *ngFor="let row of table.rows;let r = index" >
                                    <tr *ngIf="row.check">
                                        <th scope="row" style="font-weight: bold">
                                            <span>{{row.mon}} Months</span> / {{row.mil|number:0}}
                                        </th>
                                    <ng-container *ngFor="let col of table.cols;let c = index" >
                                        <td *ngIf="col.check">
                                            <ng-container *ngIf="table.data[r][c][0]>0">
                                            <div class="custcheck" *ngIf="table.data[r][c]!==undefined">
                                                <input name="plan" id="cell{{table.program+table.coverage+r+c}}" type="checkbox" class="c2" [checked]="table.data[r][c][2]==1" (change)="selectCov($event,p,t,r,c)">
                                                <label for="cell{{table.program+table.coverage+r+c}}"></label>
                                            </div>
                                            <ng-container *ngFor="let inAr of table.data[r][c];let g = index">
                                                <label *ngIf="g==0" class="checklabel labelprice" for="cell{{table.program+table.coverage+r+c}}">{{ inAr | currency}}</label>
                                            </ng-container>
                                            </ng-container>
                                            <ng-container *ngIf="table.data[r][c][0]<0">N/A</ng-container>
                                        </td>
                                    </ng-container>
                                    </tr>
                                    </ng-container>
                                </tbody>
                            </table>
                        </div>
                    </ng-container>
                    
                    <hr *ngIf="p<(pagedata.body.tables.length-1) && firsttable!==(p+1)" style="border-top:1px solid black;">
                    <hr *ngIf="p<(pagedata.body.tables.length-1) && firsttable!==(p+1)" style="border-top:1px solid black;">
                </ng-container>
                </ng-container>

                </div>
                <div class="col-xs-12"><hr id="userinfo">
                <h1>Save Quote</h1></div>
                <div class="col-sm-6">
                    <label class="flat-input inputlabel">*Stock # / Member ID 
                            <span class="errorspan2" [class.opqquezero]="stock.message===''" [class.alert-danger]="stock.erlevel==='D'" [class.validating]="validating">{{stock.message}}</span> 
                    </label>
                    <div class="flat-input w100">
                        <input autocomplete="new-password{{ran}}"  (change)="onChange()" name="stock{{ran}}" type="text"  placeholder="Stock # / Member ID " [class.required]="stock.message !== ''"  [class.validating]="validating"  [(ngModel)]="stock.value" maxlength="15">
                    </div>
                </div>
                <div class="clearfix"></div>
                <div class="col-sm-6">
                    <label class="flat-input inputlabel">*First Name 
                            <span class="errorspan2" [class.opqquezero]="first.message===''" [class.alert-danger]="first.erlevel==='D'" [class.validating]="validating">{{first.message}}</span> 
                    </label>
                    <div class="flat-input w100">
                        <input autocomplete="new-password{{ran}}"  (change)="onChange()" name="first{{ran}}" type="text"  placeholder="First Name" [class.required]="first.message !== ''"  [class.validating]="validating"  [(ngModel)]="first.value" maxlength="30">
                    </div>
                </div>
                <div class="col-sm-6">
                    <label class="flat-input inputlabel">*Last Name 
                            <span class="errorspan2" [class.opqquezero]="last.message===''" [class.alert-danger]="last.erlevel==='D'" [class.validating]="validating">{{last.message}}</span> 
                    </label>
                    <div class="flat-input w100">
                        <input autocomplete="new-password{{ran}}"  (change)="onChange()" name="last{{ran}}" type="text"  placeholder="Last Name" [class.required]="last.message !== ''"  [class.validating]="validating"  [(ngModel)]="last.value" maxlength="30">
                    </div>
                </div>
                
                <div class="col-sm-6">
                    <label class="flat-input inputlabel">Email 
                            <span class="errorspan2" [class.opqquezero]="email.message===''" [class.alert-danger]="email.erlevel==='D'" [class.validating]="validating">{{email.message}}</span> 
                    </label>
                    <div class="flat-input w100">
                        <input autocomplete="new-password{{ran}}"  (change)="onChange()" name="email{{ran}}" type="text"  placeholder="Email" [class.required]="email.message !== ''"  [class.validating]="validating"  [(ngModel)]="email.value" maxlength="60">
                    </div>
                </div>
                <div class="col-sm-6">
                    <label class="flat-input inputlabel">Phone 
                            <span class="errorspan2" [class.opqquezero]="phone.message===''" [class.alert-danger]="phone.erlevel==='D'"  [class.validating]="validating">{{phone.message}}</span> 
                    </label>
                    <div class="flat-input w100">
                        <input autocomplete="new-password{{ran}}"  (change)="onChange()" name="phone{{ran}}" type="tel"  placeholder="Phone" [class.required]="phone.message !== ''" (keyup)="formatPhone()" [class.validating]="validating"  [(ngModel)]="phone.value" maxlength="14">
                    </div>
                </div>
                <div class="col-sm-6">
                    <label class="flat-input inputlabel">Address 1
                            <span class="errorspan2" [class.opqquezero]="adr1.message===''" [class.alert-danger]="adr1.erlevel==='D'" [class.validating]="validating">{{adr1.message}}</span> 
                    </label>
                    <div class="flat-input w100">
                        <input autocomplete="new-password{{ran}}"  (change)="onChange()" name="adr1{{ran}}" type="text"  placeholder="Address 1" [class.required]="adr1.message !== ''"  [class.validating]="validating"  [(ngModel)]="adr1.value" maxlength="50">
                    </div>
                </div>
                <div class="col-sm-6">
                    <label class="flat-input inputlabel">Address 2
                            <span class="errorspan2" [class.opqquezero]="adr2.message===''" [class.alert-danger]="adr2.erlevel==='D'" [class.validating]="validating">{{adr2.message}}</span> 
                    </label>
                    <div class="flat-input w100">
                        <input autocomplete="new-password{{ran}}"  (change)="onChange()" name="adr2{{ran}}" type="text"  placeholder="Address 2" [class.required]="adr2.message !== ''"  [class.validating]="validating"  [(ngModel)]="adr2.value" maxlength="50">
                    </div>
                </div>
                <div class="col-sm-6">
                    <label class="flat-input inputlabel">City 
                            <span class="errorspan2" [class.opqquezero]="city.message===''" [class.alert-danger]="city.erlevel==='D'" [class.validating]="validating">{{city.message}}</span> 
                    </label>
                    <div class="flat-input w100">
                        <input autocomplete="new-password{{ran}}"  (change)="onChange()" name="City{{ran}}" type="text"  placeholder="City" [class.required]="city.message !== ''"  [class.validating]="validating"  [(ngModel)]="city.value" maxlength="30">
                    </div>
                </div>

                <div class="col-sm-6">
                    <div class="col-xs-7"  style="padding-left: 0">
                        <label class="flat-input inputlabel">State 
                            <span class="errorspan2" [class.opqquezero]="state.message===''" [class.alert-danger]="state.erlevel==='D'" [class.validating]="validating">{{state.message}}</span> 
                        </label>
                        <span class="flat-input">
                           <select  autocomplete="new-password"  (change)="onChange()" class="form__select w100" name="state"  [(ngModel)]="state.value" [class.required]="state.message !==''"  [class.validating]="validating">
                                <option value="">Select</option>                                    
                                <option *ngFor="let statesl of pagedata.body.states" [value]="statesl.code" [attr.selected]="statesl.code==state.value ? true : null">{{statesl.desc}}</option>
                            </select>
                        </span>
                    </div>
                    <div class="col-xs-5" style="padding-right: 0">
                    <label class="flat-input inputlabel">Zip 
                            <span class="errorspan2" [class.opqquezero]="zip.message===''" [class.alert-danger]="zip.erlevel==='D'" [class.validating]="validating">{{zip.message}}</span> 
                        </label>
                        <div class="flat-input w100">
                            <input autocomplete="new-password{{ran}}" class="w100" (change)="onChange()" name="zip{{ran}}" type="text"  placeholder="Zip" [class.required]="zip.message !== ''"  [class.validating]="validating"  [(ngModel)]="zip.value" maxlength="12" style="margin-bottom:7px">
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <label class="flat-input inputlabel">Co-buyer First Name 
                        <span class="errorspan2" [class.opqquezero]="cbfirst.message===''" [class.alert-danger]="cbfirst.erlevel==='D'" [class.validating]="validating">{{cbfirst.message}}</span> 
                    </label>
                    <div class="flat-input w100">
                        <input autocomplete="new-password{{ran}}"  (change)="onChange()" name="cbfirst{{ran}}" type="text"  placeholder="Co-buyer First Name" [class.required]="cbfirst.message !== ''"  [class.validating]="validating"  [(ngModel)]="cbfirst.value" maxlength="30">
                    </div>
                </div>
                <div class="col-sm-6">
                    <label class="flat-input inputlabel">Co-buyer Last Name 
                        <span class="errorspan2" [class.opqquezero]="cblast.message===''" [class.alert-danger]="cblast.erlevel==='D'" [class.validating]="validating">{{cblast.message}}</span> 
                    </label>
                    <div class="flat-input w100">
                        <input autocomplete="new-password{{ran}}"  (change)="onChange()" name="cblast{{ran}}" type="text"  placeholder="Co-buyer Last Name" [class.required]="cblast.message !== ''"  [class.validating]="validating"  [(ngModel)]="cblast.value" maxlength="30">
                    </div>
                </div>
                <div class="col-xs-12">
                    <span class="flat-input">
                        <button name="submit" type="submit" class="flat-button pull-right" id="submit" title="Continue">Continue</button>
                    </span>
                </div>
            </form>


            <form class="contactform style4 clearfix panel-body" method="post" action="javascript:void(0);"  novalidate *ngIf="pagedata.body.pagemode=='R'"  autocomplete="off">
                    <!--Tables-->
                    <div class="col-md-12" style="padding:0">
                        <ng-container *ngFor="let element of pagedata.body.tables;let p = index">
                        <ng-container *ngIf="element.show">
                            <div class="alert alert-info" *ngIf="element.errorDetail !=='' && element.errorDetail !== undefined" style="margin-bottom: 0">
                                {{xlateprg(element.prgm,element.ratc) +': '+element.errorDetail}}
                            </div>
                            <div class="alert alert-danger" *ngIf="element.errmsg !=='' && element.errmsg !== undefined && element.errorDetail==undefined" style="margin-bottom: 0">
                                {{xlateprg(element.prgm,element.ratc) +': '+element.errmsg}}
                            </div>
                            <div class="col-md-12" style="padding: 15px 0 0 0;" *ngIf="element.showct">
                                <div class="text-right" *ngIf="element.rates !== undefined && element.rates.length > 0">

                                    <span [class.hidden]="element.catg !== 'OTC'" style="margin:0 3px;width:80px;float:right;padding-left:8px;">
                                        : [{{element.onetime | currency }}]
                                    </span>
                                    <ng-container *ngFor="let cont of pagedata.body.contracts">
                                        <span style="float:right" *ngIf="element.ctrct==(cont.prgm.padEnd(20) + cont.code.padEnd(30) + cont.valu) ? true : null">{{cont.desc}}</span>
                                    </ng-container>
                                    <h6 style="margin:4px 10px 0 0;float:right;">Contract Type:</h6>

                                </div>
                            </div>
                            <div class="clearfix"></div>
                            <div class="well well-sm" style="background:white">
                                <h3 class="coverage">{{element.desc}}</h3>
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th scope="col">
                                                <b>Coverage</b>
                                            </th>
                                            <th scope="col">
                                                <b>Term</b>
                                            </th>
                                            <th scope="col">
                                                <b>Deductible</b>
                                            </th>
                                            <th scope="col">
                                                <b>Price</b>
                                            </th>
                                            <th scope="col" class="text-center">
                                                <b>Select</b>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <ng-container *ngFor="let table of element.rates;let t = index">
                                            <ng-container *ngFor="let row of table.rows;let r = index">
                                                <ng-container *ngFor="let col of table.cols;let c = index" >
                                                    <tr *ngIf="table.data[r][c]!==undefined && table.data[r][c][2]==1">
                                                        <td style="font-weight: bold">
                                                            <span>{{table.title}}
                                                            <span style="color:gray" *ngIf="table.nup =='N'">- [New]</span>
                                                            <span style="color:gray" *ngIf="table.nup =='U'">- [Used]</span>
                                                            <span style="color:gray" *ngIf="table.nup =='P'">- [Program]</span></span>
                                                        </td>
                                                        <td style="font-weight: bold">
                                                            <span>{{row.mon}} Months</span> / {{row.mil|number:0}}</td>
                                                        <td style="font-weight: bold">{{ col.ded | currency}}</td>
                                                        <td style="font-weight: bold">{{ table.data[r][c][0] | currency}}</td>
                                                        <td class="text-center">
                                                            <div class="custradio w100">
                                                                <input type="radio" value="{{p.toString().padEnd(4)}}{{t.toString().padEnd(4)}}{{r.toString().padEnd(4)}}{{c.toString().padEnd(4)}}" id="chk{{p}}{{t}}{{r}}{{c}}" name="chk{{p}}{{t}}" [(ngModel)]="element.selected">
                                                                <label for="chk{{p}}{{t}}{{r}}{{c}}"></label>
                                                            </div>
                                                        </td>
                                                    </tr>
                                                </ng-container>

                                            </ng-container>

                                        </ng-container>
                                    </tbody>
                                </table>
                                <div class="col-xs-12">
                                    <span class="flat-input">
                                        <button name="submit" style="background:#f19614" type="submit" (click)="createCont(element.selected)" class="flat-button pull-right" id="submit" title="Continue">Create Contract</button>
                                    </span>
                                </div>
                                <div class="clearfix"></div>
                            </div>
                            <hr>
                        </ng-container>
                    </ng-container>
                    </div>
                    
                </form>


            </div>
        </div>
    </div>
    <div class="loading hidden" id="calculating" ><div class="bar"><p>Preparing quote please wait...</p></div></div>
</section>
<app-footer></app-footer>